import{V as ie,r as u,j as e,W as de,ar as fe,X as he,Y as Ne,B as K,Z as ue,_ as Q,ao as X,af as Z,f as $,aE as be,aH as _e,aq as ve,a1 as Se,a2 as R,e as J,t as W,n as S,o as k,a3 as we,a4 as ke,a5 as Fe,a6 as Te,a7 as De,y as Ve,F as Me,g as V,h as M,i as T,S as q,k as I,s as z,v as L,w as E,x as U,l as O,I as B,aI as me,aa as Ie,b as Oe,ad as Ke,ae as Ae,ag as Pe,ah as Re,ai as He,aj as Y,ak as qe,al as ze,am as ae,H as Le,E as Ee,T as Ue,J as Be,M as Qe,c as Xe}from"./index-j9nM6RGn.js";import{C as ne,L as le,d as $e}from"./debounce-DrFXsI8H.js";import{D}from"./data-table-column-header-B3Lge1xn.js";import{u as Je,D as We,I as ge,M as Ye,C as Ze,a as Ge,f as ce,b as es,g as ss,c as ts,d as as,e as ns,h as ls,i as cs}from"./index-uyHfpxmr.js";import{I as rs}from"./IconEdit-gCz2Ttuw.js";import{b as os,o as is,a as ds,D as hs,C as us}from"./contracts-delete-dialog-Uc6-Fwc0.js";import{u as ms}from"./schema-eaPLp-Z-.js";import{I as re}from"./IconPlus-C2M1mHCj.js";import{D as gs}from"./data-table-faceted-filter-CnJp8diV.js";import"./alert-gbH3okgA.js";import"./IconAlertTriangle-D5iXQf0H.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ps=ie("outline","file-plus","IconFilePlus",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M12 11l0 6",key:"svg-2"}],["path",{d:"M9 14l6 0",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var xs=ie("outline","user-edit","IconUserEdit",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h3.5",key:"svg-1"}],["path",{d:"M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z",key:"svg-2"}]]);const pe=de.createContext(null);function js({children:s}){const[n,l]=Je(null),[m,i]=u.useState(null),[d,g]=u.useState(null);return e.jsx(pe,{value:{open:n,setOpen:l,currentRow:m,setCurrentRow:i,currentRowIndex:d,setCurrentRowIndex:g},children:s})}const G=()=>{const s=de.useContext(pe);if(!s)throw new Error("useContracts has to be used within <ContractsContext>");return s};function ys({row:s}){const{setOpen:n,setCurrentRow:l,setCurrentRowIndex:m}=G(),{user:i}=fe.getState().auth,d=i==null?void 0:i.role;return d==="customer"?null:e.jsxs(he,{modal:!1,children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(K,{variant:"ghost",className:"flex h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(ue,{align:"end",className:"w-[160px]",children:[s.getValue("status")==="active"&&e.jsxs(e.Fragment,{children:[e.jsxs(Q,{onClick:()=>{l(s.original),m(s.index),n("edit")},children:["Chỉnh sửa",e.jsx(X,{children:e.jsx(rs,{size:16})})]}),e.jsx(Z,{}),e.jsxs(Q,{children:["Thêm/ Sửa người ở",e.jsx(X,{children:e.jsx(xs,{size:16})})]})]}),(d==="admin"||d==="owner")&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsxs(Q,{onClick:()=>{l(s.original),m(s.index),n("delete")},className:"!text-red-500",children:[s.original.status!=="active"?"Xóa":"Ngừng hợp đồng",e.jsx(X,{children:e.jsx(ge,{size:16})})]})]})]})]})}const Cs=[{id:"select",header:({table:s})=>e.jsx(ne,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:n=>s.toggleAllPageRowsSelected(!!n),"aria-label":"Select all",className:"translate-y-[2px]"}),meta:{className:$("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},cell:({row:s})=>e.jsx(ne,{checked:s.getIsSelected(),onCheckedChange:n=>s.toggleSelected(!!n),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"id",header:({column:s})=>e.jsx(D,{column:s,title:"ID Hợp đồng"}),cell:({row:s})=>e.jsx(le,{className:"max-w-36",children:s.getValue("id")}),meta:{className:$("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableHiding:!1},{accessorKey:"room_name",header:({column:s})=>e.jsx(D,{column:s,title:"Phòng"}),cell:({row:s})=>e.jsx(le,{className:"max-w-36",children:s.getValue("room_name")}),meta:{className:"w-36"}},{accessorKey:"user_name",header:({column:s})=>e.jsx(D,{column:s,title:"Khách hàng"}),cell:({row:s})=>e.jsx("div",{className:"w-fit text-nowrap",children:s.getValue("user_name")})},{accessorKey:"branch_name",header:({column:s})=>e.jsx(D,{column:s,title:"Chi nhánh"}),cell:({row:s})=>e.jsx("div",{className:"w-fit text-nowrap",children:s.getValue("branch_name")})},{accessorKey:"start_date",header:({column:s})=>e.jsx(D,{column:s,title:"Ngày bắt đầu"}),cell:({row:s})=>e.jsx("div",{children:new Date(s.getValue("start_date")).toLocaleDateString()})},{accessorKey:"end_date",header:({column:s})=>e.jsx(D,{column:s,title:"Ngày kết thúc"}),cell:({row:s})=>e.jsx("div",{children:new Date(s.getValue("end_date")).toLocaleDateString()})},{accessorKey:"deposit",header:({column:s})=>e.jsx(D,{column:s,title:"Tiền cọc"}),cell:({row:s})=>e.jsx("div",{children:be(s.getValue("deposit"))})},{accessorKey:"status",header:({column:s})=>e.jsx(D,{column:s,title:"Trạng thái"}),cell:({row:s})=>{const n=s.getValue("status"),l={active:"Hoạt động",expired:"Hết hạn",cancelled:"Đã hủy",ended:"Đã kết thúc"},m=_e.get(n)||"bg-gray-500";return e.jsx("div",{className:"flex space-x-2",children:e.jsx(ve,{variant:"outline",className:$("capitalize",m),children:l[n]||"Không xác định"})})},filterFn:(s,n,l)=>l.includes(s.getValue(n)),enableHiding:!1,enableSorting:!1},{id:"actions",cell:ys}];function oe({currentRow:s,open:n,onOpenChange:l,page:m,limit:i,branchId:d,status:g,search:j}){var se,te;const c=!!s,b=Se(),[y,_]=u.useState(!1),[v,h]=u.useState(!1),{data:C=[]}=R({queryKey:["branches"],queryFn:()=>k.getAllBranches().then(t=>t.data)}),{data:A=[]}=R({queryKey:["occupants",s==null?void 0:s.room_id],queryFn:()=>c&&(s!=null&&s.room_id)?k.getOccupantsByRoom(s.room_id).then(t=>t.data.map(a=>({user_id:a.user_id,relation:a.relation||"",name:a.user_name||""}))):Promise.resolve([]),enabled:c}),{data:f}=R({queryKey:["users","customer"],queryFn:async()=>(await k.getAllUsers({role:"customer"})).data}),{data:N}=R({queryKey:["rooms",d],queryFn:async()=>(await k.getAllRooms({branchId:d,status:"available"})).data}),r=J({resolver:W(os),defaultValues:c?{room_id:s.room_id,user_id:s.user_id,start_date:s.start_date,end_date:s.end_date,deposit:Number(s.deposit)||0,branch_id:s.branch_id,status:s.status,isEdit:c,occupants:A||[]}:{room_id:0,user_id:0,start_date:"",end_date:"",deposit:0,branch_id:parseInt(d)||0,status:"active",isEdit:c,occupants:[]}}),F=J({resolver:W(ms),defaultValues:{username:"",email:"",password:"",role:"customer",name:"",phone:""}}),p=J({resolver:W(is),defaultValues:{user_id:0,relation:""}}),w=u.useCallback((t,a)=>{var o,x;S({title:a,description:((x=(o=t.response)==null?void 0:o.data)==null?void 0:x.message)||"Lỗi hệ thống, vui lòng thử lại sau",variant:"destructive"})},[]),xe=u.useCallback(async t=>{var a,o;try{const x=await k.createUser(t);b.invalidateQueries({queryKey:["users","customer"]}),v?p.setValue("user_id",Number(x.data.id)):r.setValue("user_id",Number(x.data.id)),S({title:"Tạo khách mới thành công!"}),_(!1)}catch(x){S({title:"Tạo khách mới thất bại",description:((o=(a=x.response)==null?void 0:a.data)==null?void 0:o.message)||"Lỗi hệ thống, vui lòng thử lại sau",variant:"destructive"})}},[r,p,b,v,w]),je=u.useCallback(async t=>{var H;const a=r.getValues("occupants")||[];if(a.some(P=>P.user_id===t.user_id)){S({title:"Người ở cùng đã tồn tại",description:"Người ở cùng này đã được thêm vào hợp đồng.",variant:"destructive"});return}const x={user_id:t.user_id,relation:t.relation||"",name:((H=f==null?void 0:f.find(P=>Number(P.id)===t.user_id))==null?void 0:H.name)||""};r.setValue("occupants",[...a,x]),h(!1),p.reset()},[r,p,f]),ye=u.useCallback(async t=>{var a,o;try{const H=(r.getValues("occupants")||[]).filter(P=>P.user_id!==t);r.setValue("occupants",H)}catch(x){S({title:"Lỗi khi xóa người ở cùng",description:((o=(a=x.response)==null?void 0:a.data)==null?void 0:o.message)||"Lỗi hệ thống, vui lòng thử lại sau",variant:"destructive"})}},[r]),Ce=u.useCallback(async t=>{if(!t.user_id){S({title:"Vui lòng chọn khách hàng hoặc thêm khách mới!",variant:"destructive"});return}const a={room_id:t.room_id,user_id:t.user_id,start_date:t.start_date,end_date:t.end_date,deposit:Number(t.deposit)??0,branch_id:t.branch_id,status:t.status};try{const o=c?await k.updateContract({...a,id:s.id}):await k.createContract(a);if(!o||o.status!=="success"){S({title:"Có lỗi xảy ra khi tạo hoặc cập nhật hợp đồng!"});return}if(t.occupants&&t.occupants.length>0){if((await k.updateRoomOccupants(t.room_id,t.occupants)).status!=="success"){S({title:"Có lỗi xảy ra khi cập nhật người ở cùng!"});return}b.invalidateQueries({queryKey:["occupants",t.room_id]})}b.invalidateQueries({queryKey:["contracts",m,i,d,g,j]}),S({title:c?"Cập nhật hợp đồng thành công!":"Tạo hợp đồng thành công!"}),r.reset(),l(!1)}catch(o){w(o,c?"Cập nhật hợp đồng thất bại":"Tạo hợp đồng thất bại")}},[c,s,r,b,m,i,d,g,j,l,w]);u.useEffect(()=>{n&&c&&A.length>0&&r.setValue("occupants",A.map(t=>({...t,relation:t.relation||"",name:t.name||""})))},[n,c,A]);const ee=c?[{label:s.room_name,value:s.room_id.toString()},...(N==null?void 0:N.filter(t=>t.id!==s.room_id).map(t=>({label:t.name,value:t.id.toString()})))||[]]:(N==null?void 0:N.map(t=>({label:t.name,value:t.id.toString()})))||[];return e.jsxs(e.Fragment,{children:[e.jsx(we,{open:n,onOpenChange:t=>{r.reset(),l(t)},children:e.jsxs(ke,{className:"sm:max-w-lg",children:[e.jsxs(Fe,{className:"text-left",children:[e.jsx(Te,{children:c?"Chỉnh sửa hợp đồng":"Thêm hợp đồng mới"}),e.jsxs(De,{children:[c?"Chỉnh sửa hợp đồng tại đây.":"Tạo hợp đồng mới tại đây."," Nhấp vào lưu khi bạn hoàn tất."]})]}),e.jsx(Ve,{className:"-mr-4 w-full py-1 pr-4",children:e.jsx(Me,{...r,children:e.jsxs("form",{id:"contract-form",onSubmit:r.handleSubmit(Ce),className:"space-y-4 p-0.5",children:[e.jsx(V,{control:r.control,name:"branch_id",render:({field:t})=>e.jsxs(M,{className:"grid grid-cols-6 items-center gap-x-4 gap-y-1 space-y-0",children:[e.jsx(T,{className:"col-span-2 text-right",children:"Chi nhánh"}),e.jsxs(q,{onValueChange:a=>t.onChange(parseInt(a)),value:t.value.toString(),children:[e.jsx(I,{className:"col-span-4",children:e.jsx(z,{children:e.jsx(L,{placeholder:"Chọn chi nhánh"})})}),e.jsx(E,{children:C==null?void 0:C.map(a=>e.jsx(U,{value:a.id.toString(),children:a.name},a.id))})]}),e.jsx(O,{className:"col-span-4 col-start-3"})]})}),e.jsx(V,{control:r.control,name:"room_id",render:({field:t})=>e.jsxs(M,{className:"grid grid-cols-6 items-center gap-x-4 gap-y-1 space-y-0",children:[e.jsx(T,{className:"col-span-2 text-right",children:"Phòng"}),e.jsxs(q,{onValueChange:a=>t.onChange(parseInt(a)),value:t.value.toString(),children:[e.jsx(I,{className:"col-span-4",children:e.jsx(z,{children:e.jsx(L,{placeholder:"Chọn phòng"})})}),e.jsx(E,{children:ee.map(a=>e.jsx(U,{value:a.value,children:a.label},a.value))})]}),e.jsx(O,{className:"col-span-4 col-start-3"})]})}),e.jsx(V,{control:r.control,name:"user_id",render:({field:t})=>e.jsxs(M,{className:"grid grid-cols-6 items-center gap-x-4 gap-y-1 space-y-0",children:[e.jsx(T,{className:"col-span-2 text-right",children:"Khách hàng"}),e.jsxs(q,{onValueChange:a=>{t.onChange(parseInt(a))},value:t.value.toString(),children:[e.jsx(I,{className:"col-span-4",children:e.jsx(z,{children:e.jsx(L,{placeholder:"Chọn khách hàng"})})}),e.jsxs(E,{children:[f==null?void 0:f.map(a=>e.jsx(U,{value:a.id.toString(),children:a.username},a.id)),e.jsxs("a",{href:"#",onClick:a=>{a.preventDefault(),_(!0)},className:"flex items-center px-2 py-1 text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(re,{className:"mr-1 h-4 w-4"}),"Thêm khách mới"]})]})]}),e.jsx(O,{className:"col-span-4 col-start-3"})]})}),e.jsx(V,{control:r.control,name:"start_date",render:({field:t})=>e.jsxs(M,{className:"grid grid-cols-6 items-center gap-x-4 gap-y-1 space-y-0",children:[e.jsx(T,{className:"col-span-2 text-right",children:"Ngày bắt đầu"}),e.jsx(I,{children:e.jsx(B,{type:"date",className:"col-span-4",...t})}),e.jsx(O,{className:"col-span-4 col-start-3"})]})}),e.jsx(V,{control:r.control,name:"end_date",render:({field:t})=>e.jsxs(M,{className:"grid grid-cols-6 items-center gap-x-4 gap-y-1 space-y-0",children:[e.jsx(T,{className:"col-span-2 text-right",children:"Ngày kết thúc"}),e.jsx(I,{children:e.jsx(B,{type:"date",className:"col-span-4",...t})}),e.jsx(O,{className:"col-span-4 col-start-3"})]})}),e.jsx(V,{control:r.control,name:"deposit",render:({field:t})=>e.jsxs(M,{className:"grid grid-cols-6 items-center gap-x-4 gap-y-1 space-y-0",children:[e.jsx(T,{className:"col-span-2 text-right",children:"Tiền cọc"}),e.jsx(I,{children:e.jsx(B,{type:"number",className:"col-span-4",value:t.value??"",onChange:a=>{const o=a.target.value;t.onChange(o?parseFloat(o):0)}})}),e.jsx(O,{className:"col-span-4 col-start-3"})]})}),e.jsx(V,{control:r.control,name:"status",render:({field:t})=>e.jsxs(M,{className:"grid grid-cols-6 items-center gap-x-4 gap-y-1 space-y-0",children:[e.jsx(T,{className:"col-span-2 text-right",children:"Trạng thái"}),e.jsxs(q,{onValueChange:t.onChange,value:t.value,children:[e.jsx(I,{className:"col-span-4",children:e.jsx(z,{children:e.jsx(L,{placeholder:"Chọn trạng thái"})})}),e.jsx(E,{children:me.map(({label:a,value:o})=>e.jsx(U,{value:o,children:a},o))})]}),e.jsx(O,{className:"col-span-4 col-start-3"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:"Người ở cùng"}),e.jsxs(K,{type:"button",variant:"outline",size:"sm",onClick:()=>h(!0),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Thêm người ở cùng"]})]}),(se=r.watch("occupants"))==null?void 0:se.map((t,a)=>{var o;return e.jsxs("div",{className:"flex items-center justify-between border rounded px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((o=f==null?void 0:f.find(x=>Number(x.id)===t.user_id))==null?void 0:o.name)||"Không rõ tên"}),e.jsx("p",{className:"text-xs italic text-muted-foreground",children:t.relation})]}),e.jsx(K,{type:"button",variant:"ghost",size:"icon",onClick:()=>ye(t.user_id),children:e.jsx(ge,{className:"w-4 h-4 text-red-500"})})]},a)})]})]})})}),e.jsx(Ie,{children:e.jsx(K,{type:"submit",form:"contract-form",children:"Xác nhận"})})]})}),e.jsx(ds,{form:F,handleCreateUser:xe,open:y,onOpenChange:_}),e.jsx(hs,{form:p,handleAddOccupant:je,currentRow:c?s:{name:(te=ee.find(t=>{var a;return t.value===((a=r.watch("room_id"))==null?void 0:a.toString())}))==null?void 0:te.label},users:f||[],open:v,onOpenChange:h,onAddUserOpen:()=>{_(!0),h(!1)}})]})}function fs({page:s,limit:n,branchId:l,status:m,search:i}){const{open:d,setOpen:g,currentRow:j,setCurrentRow:c}=G();return d?e.jsxs(e.Fragment,{children:[d==="add"&&e.jsx(oe,{page:s,limit:n,branchId:l,status:m,search:i,open:!0,onOpenChange:()=>g("add")},"contract-add"),j&&e.jsxs(e.Fragment,{children:[d==="edit"&&e.jsx(oe,{page:s,limit:n,branchId:l,status:m,search:i,open:!0,onOpenChange:()=>{g("edit"),setTimeout(()=>{c(null)},500)},currentRow:j},`contract-edit-${j.id}`),d==="delete"&&e.jsx(us,{open:!0,onOpenChange:()=>{g("delete"),setTimeout(()=>{c(null)},500)},contract_id:j.id,type:"end_contract"},`contract-delete-${j.id}`)]})]}):null}function Ns(){const{setOpen:s}=G(),{user:n}=Oe();return((n==null?void 0:n.role)||"customer")==="customer"?null:e.jsx("div",{className:"flex gap-2",children:e.jsxs(K,{className:"space-x-1",onClick:()=>s("add"),children:[e.jsx("span",{children:"Thêm hợp đồng"})," ",e.jsx(ps,{size:18})]})})}const bs={id:"ID Hợp đồng",room_name:"Phòng",user_name:"Khách hàng",branch_name:"Chi nhánh",start_date:"Ngày bắt đầu",end_date:"Ngày kết thúc",deposit:"Tiền cọc"};function _s({table:s}){return e.jsxs(he,{modal:!1,children:[e.jsx(Ke,{asChild:!0,children:e.jsxs(K,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(Ye,{className:"mr-2 h-4 w-4"}),"Xem"]})}),e.jsxs(ue,{align:"end",className:"w-[150px]",children:[e.jsx(Ae,{children:"Hiển thị cột"}),e.jsx(Z,{}),s.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()).map(n=>e.jsx(Pe,{className:"capitalize",checked:n.getIsVisible(),onCheckedChange:l=>n.toggleVisibility(!!l),children:bs[n.id]},n.id))]})]})}function vs({table:s,setSearch:n,setBranchId:l,setStatus:m,status:i}){var y,_,v;const d=s.getState().columnFilters.length>0||!!((y=s.getColumn("id"))!=null&&y.getFilterValue())||!!((_=s.getColumn("status"))!=null&&_.getFilterValue()),g=u.useMemo(()=>$e(h=>n(h),500),[n]),j=h=>{var C;(C=s.getColumn("id"))==null||C.setFilterValue(h),g(h)},c=i?i.split(",").filter(Boolean):[],b=h=>{const C=h.join(",");C!==i&&m(C)};return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(B,{placeholder:"Tìm kiếm hợp đồng...",value:((v=s.getColumn("id"))==null?void 0:v.getFilterValue())??"",onChange:h=>j(h.target.value),className:"h-8 w-[150px] lg:w-[250px]"}),e.jsx("div",{className:"flex gap-x-2",children:s.getColumn("status")&&e.jsx(gs,{column:s.getColumn("status"),title:"Trạng thái",options:me.map(h=>({label:h.label,value:h.value})),selected:c,onChange:b})}),d&&e.jsxs(K,{variant:"ghost",onClick:()=>{n(""),m(""),l(""),s.resetColumnFilters()},className:"h-8 px-2 lg:px-3",children:["Xóa bộ lọc",e.jsx(Ze,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(_s,{table:s})]})}function Ss({columns:s,data:n,pagination:l,setPage:m,setLimit:i,setSearch:d,setBranchId:g,setStatus:j,status:c}){var r;const[b,y]=u.useState({}),[_,v]=u.useState({}),[h,C]=u.useState([]),[A,f]=u.useState([]),N=Ge({data:n,columns:s,state:{sorting:A,columnVisibility:_,rowSelection:b,columnFilters:h,pagination:{pageIndex:l.current_page-1,pageSize:l.limit}},manualPagination:!0,pageCount:l.total_pages,enableRowSelection:!0,onRowSelectionChange:y,onSortingChange:f,onColumnFiltersChange:C,onColumnVisibilityChange:v,getCoreRowModel:cs(),getFilteredRowModel:ls(),getPaginationRowModel:ns(),getSortedRowModel:as(),getFacetedRowModel:ts(),getFacetedUniqueValues:ss()});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(vs,{table:N,setSearch:d,setBranchId:g,setStatus:j,status:c}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Re,{children:[e.jsx(He,{children:N.getHeaderGroups().map(F=>e.jsx(Y,{className:"group/row",children:F.headers.map(p=>{var w;return e.jsx(qe,{colSpan:p.colSpan,className:((w=p.column.columnDef.meta)==null?void 0:w.className)??"",children:p.isPlaceholder?null:ce(p.column.columnDef.header,p.getContext())},p.id)})},F.id))}),e.jsx(ze,{children:(r=N.getRowModel().rows)!=null&&r.length?N.getRowModel().rows.map(F=>e.jsx(Y,{"data-state":F.getIsSelected()&&"selected",className:"group/row",children:F.getVisibleCells().map(p=>{var w;return e.jsx(ae,{className:((w=p.column.columnDef.meta)==null?void 0:w.className)??"",children:ce(p.column.columnDef.cell,p.getContext())},p.id)})},F.id)):e.jsx(Y,{children:e.jsx(ae,{colSpan:s.length,className:"h-24 text-center",children:"Không có kết quả."})})})]})}),e.jsx(es,{table:N,setPage:m,setLimit:i,totalRecords:l.total_records})]})}function ws(){const[s,n]=u.useState(1),[l,m]=u.useState(10),[i,d]=u.useState(""),[g,j]=u.useState(""),[c,b]=u.useState(""),{data:y,isLoading:_,error:v}=R({queryKey:["contracts",s,l,i,g,c],queryFn:()=>k.getAllContracts({page:s,limit:l,branchId:i,status:g,search:c}),staleTime:5*60*1e3,retry:2});v&&S({variant:"destructive",title:"Lỗi khi tải danh sách hợp đồng",description:v.message,duration:5e3});const h=(y==null?void 0:y.data)||[],C=(y==null?void 0:y.pagination)||{current_page:1,limit:10,total_records:0,total_pages:1};return e.jsxs(js,{children:[e.jsxs(Le,{fixed:!0,children:[e.jsx(Ee,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(Ue,{}),e.jsx(Be,{})]})]}),e.jsx(Qe,{children:_&&!y?e.jsx("div",{className:"flex h-full items-center justify-center",children:"Đang tải hợp đồng..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Danh sách hợp đồng"}),e.jsx("p",{className:"text-muted-foreground",children:"Quản lý hợp đồng thuê phòng tại đây."})]}),e.jsx(Ns,{})]}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-x-12 lg:space-y-0",children:e.jsx(Ss,{data:h,columns:Cs,pagination:C,setPage:n,setLimit:m,setBranchId:d,setStatus:j,setSearch:b,branchId:i,status:g})})]})}),e.jsx(fs,{page:s,limit:l,branchId:i,status:g,search:c})]})}const Rs=Xe("/_authenticated/contracts/")({component:ws});export{Rs as Route};
