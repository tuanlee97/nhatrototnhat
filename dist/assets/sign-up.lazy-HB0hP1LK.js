import{r as C,b as I,u as M,d as G,e as A,t as E,z as i,j as e,f as T,F as V,g as l,h as c,i as h,k as d,I as f,l as m,P as v,B,m as R,n as g,o as k,A as U,C as z,L as K,c as D}from"./index-CJ1AcNxb.js";const H=i.object({email:i.string().min(1,{message:"Vui lòng nhập email"}).email({message:"Địa chỉ email không hợp lệ"}),username:i.string().min(1,{message:"Vui lòng nhập tên người dùng"}).min(5,{message:"Tên người dùng phải dài ít nhất 5 ký tự"}),password:i.string().min(1,{message:"Vui lòng nhập mật khẩu"}).min(6,{message:"Mật khẩu phải dài ít nhất 6 ký tự"}),confirmPassword:i.string()}).refine(r=>r.password===r.confirmPassword,{message:"Mật khâu không trùng khớp.",path:["confirmPassword"]});function X({className:r,...b}){const[y,o]=C.useState(!1),{setAuth:N}=I(),x=M(),w=G(),n=A({resolver:E(H),defaultValues:{username:"",password:"",confirmPassword:""}});async function F(s){var p,j;o(!0);const{id:t,update:a,dismiss:L}=g({title:"Đang xử lý...",description:"Đang thực hiện đăng ký tài khoản"});try{const u=await k.signUp({username:s.username,password:s.password,email:s.email}),{data:S,message:P}=u;S?(a({id:t,title:"Đăng kí thành công!",description:"Đang chuyển hướng đến trang đăng nhập..."}),setTimeout(()=>{L(),x({to:"/sign-in"})},2500)):a({id:t,title:"Có lỗi xảy ra",description:P||"Không thể hoàn tất đăng ký",variant:"destructive"})}catch(u){a({id:t,title:"Đăng kí thất bại",description:((j=(p=u.response)==null?void 0:p.data)==null?void 0:j.message)||"Lỗi hệ thống, vui lòng thử lại sau",variant:"destructive"})}finally{o(!1)}}return e.jsx("div",{className:T("grid gap-6",r),...b,children:e.jsx(V,{...n,children:e.jsx("form",{onSubmit:n.handleSubmit(F),children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{control:n.control,name:"username",render:({field:s})=>e.jsxs(c,{className:"space-y-1",children:[e.jsx(h,{children:"Tên người dùng"}),e.jsx(d,{children:e.jsx(f,{placeholder:"@username",...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:n.control,name:"email",render:({field:s})=>e.jsxs(c,{className:"space-y-1",children:[e.jsx(h,{children:"Email"}),e.jsx(d,{children:e.jsx(f,{placeholder:"name@example.com",...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:n.control,name:"password",render:({field:s})=>e.jsxs(c,{className:"space-y-1",children:[e.jsx(h,{children:"Mật khẩu"}),e.jsx(d,{children:e.jsx(v,{placeholder:"********",...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:n.control,name:"confirmPassword",render:({field:s})=>e.jsxs(c,{className:"space-y-1",children:[e.jsx(h,{children:"Xác nhận mật khẩu"}),e.jsx(d,{children:e.jsx(v,{placeholder:"********",...s})}),e.jsx(m,{})]})}),e.jsx(B,{className:"mt-2",disabled:y,children:"Đăng kí"}),e.jsxs("div",{className:"relative my-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Hoặc tiếp tục với"})})]}),e.jsx(R,{shape:"circle",width:w?300:400,onSuccess:async s=>{o(!0);try{const t=await k.googleLogin(s.credential||""),{data:a}=t;N(a.user,a.token),g({title:"Đăng nhập với Google thành công!"}),x({to:"/"})}catch{g({title:"Đăng nhập Google thất bại",description:"Có lỗi xảy ra, vui lòng thử lại",variant:"destructive"})}finally{o(!1)}},onError:()=>{g({title:"Đăng nhập Google thất bại",description:"Không thể kết nối với Google",variant:"destructive"})}})]})})})})}function q(){return e.jsx(U,{children:e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"mb-2 flex flex-col space-y-2 text-left",children:[e.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"Tạo tài khoản"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Nhập tên người dùng và mật khẩu của bạn để tạo tài khoản. ",e.jsx("br",{}),"Đã có tài khoản?"," ",e.jsx(K,{to:"/sign-in",className:"underline underline-offset-4 hover:text-primary",children:"Đăng nhập"})]})]}),e.jsx(X,{}),e.jsxs("p",{className:"mt-4 px-8 text-center text-xs text-muted-foreground",children:["Bằng cách nhấp vào đăng nhập, bạn đồng ý với"," ",e.jsx("a",{href:"/terms",className:"underline underline-offset-4 hover:text-primary font-semibold",children:"điều khoản dịch vụ"})," ","và"," ",e.jsx("a",{href:"/privacy",className:"underline underline-offset-4 hover:text-primary font-semibold",children:"chính sách bảo mật"})," ","của chúng tôi."]})]})})}const O=D("/(auth)/sign-up")({component:q});export{O as Route};
